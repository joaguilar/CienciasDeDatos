\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Tarea 2 - Anova},
            pdfauthor={Los Celtics},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Tarea 2 - Anova}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Los Celtics}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{9 de Abril, 2019}

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}

\begin{document}
\maketitle

\subsection{Carga de datos}\label{carga-de-datos}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{algodon <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"algodon.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{row.names =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Datos Cargados:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(algodon)}
\end{Highlighting}
\end{Shaded}

\begin{tabular}{l|r|r|r|r|r}
\hline
  & Observacion.1 & Observacion.2 & Observacion.3 & Observacion.4 & Observacion.5\\
\hline
Porc\_15 & 7 & 7 & 15 & 11 & 9\\
\hline
Porc\_20 & 12 & 17 & 12 & 18 & 18\\
\hline
Porc\_25 & 14 & 18 & 18 & 19 & 19\\
\hline
Porc\_30 & 19 & 25 & 22 & 19 & 23\\
\hline
Porc\_35 & 7 & 10 & 11 & 15 & 11\\
\hline
\end{tabular}

\subsection{Limpieza de datos}\label{limpieza-de-datos}

Los datos cargados no cumplen con los estÃ¡ndares de \emph{Tidy Data}
\url{https://vita.had.co.nz/papers/tidy-data.pdf} para el analisis, por
lo que es necesario al menos hacer un cambio - cambiar las observaciones
(experimentos) a filas, y mantener las variables independientes a
columnas. Afortunadamente, esto lo podemos hacer facilmente haciendo la
transpuesta:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{algodon_t <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(algodon))}
\KeywordTok{kable}\NormalTok{(algodon_t)}
\end{Highlighting}
\end{Shaded}

\begin{tabular}{l|r|r|r|r|r}
\hline
  & Porc\_15 & Porc\_20 & Porc\_25 & Porc\_30 & Porc\_35\\
\hline
Observacion.1 & 7 & 12 & 14 & 19 & 7\\
\hline
Observacion.2 & 7 & 17 & 18 & 25 & 10\\
\hline
Observacion.3 & 15 & 12 & 18 & 22 & 11\\
\hline
Observacion.4 & 11 & 18 & 19 & 19 & 15\\
\hline
Observacion.5 & 9 & 18 & 19 & 23 & 11\\
\hline
\end{tabular}

\subsection{ANOVA}\label{anova}

Calculo de ANOVA:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{algodon_stacked <-}\StringTok{ }\KeywordTok{stack}\NormalTok{(algodon_t)}
\KeywordTok{kable}\NormalTok{(algodon_stacked)}
\end{Highlighting}
\end{Shaded}

\begin{tabular}{r|l}
\hline
values & ind\\
\hline
7 & Porc\_15\\
\hline
7 & Porc\_15\\
\hline
15 & Porc\_15\\
\hline
11 & Porc\_15\\
\hline
9 & Porc\_15\\
\hline
12 & Porc\_20\\
\hline
17 & Porc\_20\\
\hline
12 & Porc\_20\\
\hline
18 & Porc\_20\\
\hline
18 & Porc\_20\\
\hline
14 & Porc\_25\\
\hline
18 & Porc\_25\\
\hline
18 & Porc\_25\\
\hline
19 & Porc\_25\\
\hline
19 & Porc\_25\\
\hline
19 & Porc\_30\\
\hline
25 & Porc\_30\\
\hline
22 & Porc\_30\\
\hline
19 & Porc\_30\\
\hline
23 & Porc\_30\\
\hline
7 & Porc\_35\\
\hline
10 & Porc\_35\\
\hline
11 & Porc\_35\\
\hline
15 & Porc\_35\\
\hline
11 & Porc\_35\\
\hline
\end{tabular}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{anova_algodon <-}\StringTok{ }\KeywordTok{aov}\NormalTok{(values }\OperatorTok{~}\StringTok{ }\NormalTok{ind, }\DataTypeTok{data =}\NormalTok{ algodon_stacked, }\DataTypeTok{qr =} \OtherTok{TRUE}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(anova_algodon)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Df Sum Sq Mean Sq F value   Pr(>F)    
## ind          4  475.8  118.94   14.76 9.13e-06 ***
## Residuals   20  161.2    8.06                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{anova_algodon}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Call:
##    aov(formula = values ~ ind, data = algodon_stacked, qr = TRUE)
## 
## Terms:
##                    ind Residuals
## Sum of Squares  475.76    161.20
## Deg. of Freedom      4        20
## 
## Residual standard error: 2.839014
## Estimated effects may be unbalanced
\end{verbatim}

De aquí podemos decir que:

\[F(4,20)=14.76\]

Este \emph{F-Test} da una valor mayor que uno, lo que significa, en
resumen, que al menos un tratamiento tiene un efecto medible sobre las
observaciones.

La explicación de lo anterior es:

ANOVA lo que hace es calcular varianzas. Estas varianzas nos indican
cuan alejados estan los datos de la media, es decir, la dispersion de
los datos. Entre mas grande sea la varianza, significa que los datos
estan mas lejos.

El \emph{F-test} lo que indica es la razón entre las varianzas de las
medias de la muestra y de las varianzas de los errores de las
observaciones de la muestra. La idea es que la varianza de las medias
deberia de ser similar a la varianza de las observaciones en caso que
las diferencias de las observaciones sean por errores, dado que tienen
el mismo origen. De no ser asi, la varianza de la menos un grupo de
medias seria mucho mayor que la varianza entre las muestras, porque
habria otro factor que esta afectando solamente a ese grupo.

Tomando el ejemplo visto en clase, si partimos que cada observación se
compone de tres partes:

\[ y_{ij} = \mu + \tau_i + \epsilon_{ij} \]

\(\mu\) = la media \(\tau\) = Efecto del í-ésimo tratamiento
\(\epsilon\) = error de la observación

Tal y como vimos en clase, de esto podemos deducir dos hipotesis:

\begin{itemize}
\tightlist
\item
  Hipotesis nula \(H_0\): los efectos de los tratamientos no no afectan,
  es decir, la media de todos los tratamientos es la misma, y todo puede
  ser explicado por \(\mu + \epsilon_{ij}\)
\item
  Hipotesis alternativa \(H_1\): Los efectos de los tratamientos si
  afectan, por lo tanto en al menos un par de tratamientos \((i,j)\),
  \(\mu_i \neq \mu_j\)
\end{itemize}

Para probar estas hipotesis, ANOVA lo que hace es calcular la dispersión
de las medias, y dividirlas por la dispersion de todas las
observaciones. Si \(\tau_i=0 \forall i\), entonces la dispersion de
todas las medias y la dispersion de todas las observaciones seria la
misma, y el \emph{F test} daría 1. De lo contrario daría un número mayor
que uno, al afectar \(\tau\) al menos a uno de los tratamientos moviendo
un poco la dispersión.

Estas varianzas las calcula ANOVA de la siguiente forma:

Adicionalmente, ANOVA utiliza los \emph{grados de libertad}. Estos son
basicamente cuanta informacion utiliza el modelo. En el caso de
variables categoricas, como en este caso, para las medias se calcula
como uno menos que el numero de niveles: \(DF_k=k-1\). En el caso del
error, se calcula como el numero de observaciones menos el numero de
niveles (o grupos) usados: \(DF_n=n-k\).

\begin{itemize}
\tightlist
\item
  Lo llamado los \emph{mean squares}. Estos son
\end{itemize}

Esto se ve reflejado dentro de los datos en el objeto ANOVA:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{summary}\NormalTok{(anova_algodon)[[}\DecValTok{1}\NormalTok{]][[}\StringTok{"Sum Sq"}\NormalTok{]][[}\DecValTok{1}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 475.76
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{(anova_algodon)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## List of 13
##  $ coefficients : Named num [1:5] 9.8 5.6 7.8 11.8 1
##   ..- attr(*, "names")= chr [1:5] "(Intercept)" "indPorc_20" "indPorc_25" "indPorc_30" ...
##  $ residuals    : Named num [1:25] -2.8 -2.8 5.2 1.2 -0.8 ...
##   ..- attr(*, "names")= chr [1:25] "1" "2" "3" "4" ...
##  $ effects      : Named num [1:25] -75.2 0.9 6.84 20.63 1.58 ...
##   ..- attr(*, "names")= chr [1:25] "(Intercept)" "indPorc_20" "indPorc_25" "indPorc_30" ...
##  $ rank         : int 5
##  $ fitted.values: Named num [1:25] 9.8 9.8 9.8 9.8 9.8 15.4 15.4 15.4 15.4 15.4 ...
##   ..- attr(*, "names")= chr [1:25] "1" "2" "3" "4" ...
##  $ assign       : int [1:5] 0 1 1 1 1
##  $ qr           :List of 5
##   ..$ qr   : num [1:25, 1:5] -5 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:25] "1" "2" "3" "4" ...
##   .. .. ..$ : chr [1:5] "(Intercept)" "indPorc_20" "indPorc_25" "indPorc_30" ...
##   .. ..- attr(*, "assign")= int [1:5] 0 1 1 1 1
##   .. ..- attr(*, "contrasts")=List of 1
##   .. .. ..$ ind: chr "contr.treatment"
##   ..$ qraux: num [1:5] 1.2 1.08 1.1 1.13 1.2
##   ..$ pivot: int [1:5] 1 2 3 4 5
##   ..$ tol  : num 1e-07
##   ..$ rank : int 5
##   ..- attr(*, "class")= chr "qr"
##  $ df.residual  : int 20
##  $ contrasts    :List of 1
##   ..$ ind: chr "contr.treatment"
##  $ xlevels      :List of 1
##   ..$ ind: chr [1:5] "Porc_15" "Porc_20" "Porc_25" "Porc_30" ...
##  $ call         : language aov(formula = values ~ ind, data = algodon_stacked, qr = TRUE)
##  $ terms        :Classes 'terms', 'formula'  language values ~ ind
##   .. ..- attr(*, "variables")= language list(values, ind)
##   .. ..- attr(*, "factors")= int [1:2, 1] 0 1
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:2] "values" "ind"
##   .. .. .. ..$ : chr "ind"
##   .. ..- attr(*, "term.labels")= chr "ind"
##   .. ..- attr(*, "order")= int 1
##   .. ..- attr(*, "intercept")= int 1
##   .. ..- attr(*, "response")= int 1
##   .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
##   .. ..- attr(*, "predvars")= language list(values, ind)
##   .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "factor"
##   .. .. ..- attr(*, "names")= chr [1:2] "values" "ind"
##  $ model        :'data.frame':   25 obs. of  2 variables:
##   ..$ values: int [1:25] 7 7 15 11 9 12 17 12 18 18 ...
##   ..$ ind   : Factor w/ 5 levels "Porc_15","Porc_20",..: 1 1 1 1 1 2 2 2 2 2 ...
##   ..- attr(*, "terms")=Classes 'terms', 'formula'  language values ~ ind
##   .. .. ..- attr(*, "variables")= language list(values, ind)
##   .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. ..$ : chr [1:2] "values" "ind"
##   .. .. .. .. ..$ : chr "ind"
##   .. .. ..- attr(*, "term.labels")= chr "ind"
##   .. .. ..- attr(*, "order")= int 1
##   .. .. ..- attr(*, "intercept")= int 1
##   .. .. ..- attr(*, "response")= int 1
##   .. .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
##   .. .. ..- attr(*, "predvars")= language list(values, ind)
##   .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "factor"
##   .. .. .. ..- attr(*, "names")= chr [1:2] "values" "ind"
##  - attr(*, "class")= chr [1:2] "aov" "lm"
\end{verbatim}

y

\[p = 9.13e-06 < 0.05\]

Al ser \(p < 0.05\), podemos decir que los resultados son
significativos, y no fueron obtenidos aleatoriamente.


\end{document}
